# 组合最优化 - 旅行商问题

## 题目描述

一个商人欲到n个城市推销商品, 每两个城市i和j之间的距离为$d_{ij}$使得商人每个城市走一遍后回到起点且所走路径最短.

## 解答

### 假设

设$x_{ij}$是标识是否选择从走城市i到城市j的路线，X是$x_{ij}$组成的矩阵。

每个城市都视为图中的一个节点，城市之间的道路视为图中的带权边。

### 模型建立

目标是所走的路径最短，由此得到**目标函数**：
$$
min\ \ \sum_{i=1}^{n}\sum_{j=1}^{n}{d_{ij}\cdot x_{ij}},\ \ i\neq j
$$
题目要求每个城市恰好走一遍并且回到原点，所以每个节点的出度和入度均为1，

同时这里我们需要使用**Miller-Tucker-Zemlin约束**消除含子环路的解：
$$
\mu_{i}-\mu_{j}+nx_{ij}\leq n-1,\ \ 1<i\ne j\leq n \\
\mu_{i}\geq 0
$$
其中n是节点个数，$\mu_{i}$我们可以认为反映了节点i的访问次序，这个不等式保证了每个节点都有一个独一无二的访问次序。

由上述分析得到**约束条件**：
$$
\sum_{i=1}^{n}{x_{ij}}=1,\ j=1,2,...,n,\ i\neq j\\
\sum_{j=1}^{n}{x_{ij}}=1,\ i=1,2,...,n,\ i\neq j\\
\mu_{i}-\mu_{j}+nx_{ij}\leq n-1,\ \ 1<i\ne j\leq n, \ \mu_{i},\mu_{j}\geq 0\\
x_{ij}\in\{0,1\},\ i,j=1,2,...,n
$$

### 程序求解

由于题目没给出数据集，我们在网上找到了一个9*9的城市距离数据集：

> d=
>
> ​	0,200,660,170,127,225,490,420,330,
> ​	200,0,820,300,90,60,310,225,151,
> ​	660,820,0,530,770,120,1110,1050,960,
> ​	170,300,530,0,280,350,600,550,450,
> ​	127,90,770,280,0,110,370,310,210,
> ​	225,60,120,350,110,0,280,250,120,
> ​	490,310,1110,600,370,280,0,290,190,
> ​	420,225,1050,550,310,250,290,0,160,
> ​	330,151,960,450,210,120,190,160,0;



使用Lingo求解，得到结果如下：

路径最短为1862，X结果如下：

                                    Variable        Value               Reduced Cost
                                    X( 1, 1)        0.000000            0.000000
                                    X( 1, 2)        0.000000            200.0000
                                    X( 1, 3)        0.000000            660.0000
                                    X( 1, 4)        0.000000            170.0000
                                    X( 1, 5)        1.000000            127.0000
                                    X( 1, 6)        0.000000            225.0000
                                    X( 1, 7)        0.000000            490.0000
                                    X( 1, 8)        0.000000            420.0000
                                    X( 1, 9)        0.000000            330.0000
                                    X( 2, 1)        0.000000            200.0000
                                    X( 2, 2)        0.000000            0.000000
                                    X( 2, 3)        0.000000            820.0000
                                    X( 2, 4)        0.000000            300.0000
                                    X( 2, 5)        0.000000            90.00000
                                    X( 2, 6)        0.000000            60.00000
                                    X( 2, 7)        0.000000            310.0000
                                    X( 2, 8)        1.000000            225.0000
                                    X( 2, 9)        0.000000            151.0000
                                    X( 3, 1)        0.000000            660.0000
                                    X( 3, 2)        0.000000            820.0000
                                    X( 3, 3)        0.000000            0.000000
                                    X( 3, 4)        1.000000            530.0000
                                    X( 3, 5)        0.000000            770.0000
                                    X( 3, 6)        0.000000            120.0000
                                    X( 3, 7)        0.000000            1110.000
                                    X( 3, 8)        0.000000            1050.000
                                    X( 3, 9)        0.000000            960.0000
                                    X( 4, 1)        1.000000            170.0000
                                    X( 4, 2)        0.000000            300.0000
                                    X( 4, 3)        0.000000            530.0000
                                    X( 4, 4)        0.000000            0.000000
                                    X( 4, 5)        0.000000            280.0000
                                    X( 4, 6)        0.000000            350.0000
                                    X( 4, 7)        0.000000            600.0000
                                    X( 4, 8)        0.000000            550.0000
                                    X( 4, 9)        0.000000            450.0000
                                    X( 5, 1)        0.000000            127.0000
                                    X( 5, 2)        1.000000            90.00000
                                    X( 5, 3)        0.000000            770.0000
                                    X( 5, 4)        0.000000            280.0000
                                    X( 5, 5)        0.000000            0.000000
                                    X( 5, 6)        0.000000            110.0000
                                    X( 5, 7)        0.000000            370.0000
                                    X( 5, 8)        0.000000            310.0000
                                    X( 5, 9)        0.000000            210.0000
                                    X( 6, 1)        0.000000            225.0000
                                    X( 6, 2)        0.000000            60.00000
                                    X( 6, 3)        1.000000            120.0000
                                    X( 6, 4)        0.000000            350.0000
                                    X( 6, 5)        0.000000            110.0000
                                    X( 6, 6)        0.000000            0.000000
                                    X( 6, 7)        0.000000            280.0000
                                    X( 6, 8)        0.000000            250.0000
                                    X( 6, 9)        0.000000            120.0000
                                    X( 7, 1)        0.000000            490.0000
                                    X( 7, 2)        0.000000            310.0000
                                    X( 7, 3)        0.000000            1110.000
                                    X( 7, 4)        0.000000            600.0000
                                    X( 7, 5)        0.000000            370.0000
                                    X( 7, 6)        0.000000            280.0000
                                    X( 7, 7)        0.000000            0.000000
                                    X( 7, 8)        0.000000            290.0000
                                    X( 7, 9)        1.000000            190.0000
                                    X( 8, 1)        0.000000            420.0000
                                    X( 8, 2)        0.000000            225.0000
                                    X( 8, 3)        0.000000            1050.000
                                    X( 8, 4)        0.000000            550.0000
                                    X( 8, 5)        0.000000            310.0000
                                    X( 8, 6)        0.000000            250.0000
                                    X( 8, 7)        1.000000            290.0000
                                    X( 8, 8)        0.000000            0.000000
                                    X( 8, 9)        0.000000            160.0000
                                    X( 9, 1)        0.000000            330.0000
                                    X( 9, 2)        0.000000            151.0000
                                    X( 9, 3)        0.000000            960.0000
                                    X( 9, 4)        0.000000            450.0000
                                    X( 9, 5)        0.000000            210.0000
                                    X( 9, 6)        1.000000            120.0000
                                    X( 9, 7)        0.000000            190.0000
                                    X( 9, 8)        0.000000            160.0000
                                    X( 9, 9)        0.000000            0.000000
    

由此得到最短路径是```1 - 5 - 2 - 8 - 7 - 9 - 6 - 3 - 4 - 1 ```

