# 常微分方程

## 题目描述

在第一次世界大战中，甲、乙两方战役的胜负，往往由双方兵力多少及战斗力强弱两个因素决定，其中，兵力因战斗及非战斗减员而减少，因增援而增加；战斗力与射击次数及命中率有关。请按照正规战争和游击战争两类情况， 应用常微分方程进行建模，分析并预测战役结局。

## 解答

### 假设

设甲、乙两方兵力（士兵数量）随时间变化的函数分别为$n_{1}(t),n_{2}(t)$

甲、乙两方每个士兵的开枪率不随时间变化，分别恒为$s_{1},s_{2}$

甲、乙两方每个士兵的命中率随时间变化的函数分别为$h_{1}(t),h_{2}(t)$

甲、乙两方单位时间内的增援数随时间变化的函数为$r_{1}(t),r_{2}(t)$

### 模型建立及求解

战争中人数的变化来源于被敌方命中的人数、非战斗因素死亡的人数、增援人数

被敌方命中的人数取决于敌方开枪率、命中率和敌方人数的乘积

非战斗死亡的人数与我方人数成正比

人数与初始人数变化不大的情况下几乎不增援，相比初始人数目前人数越少增援速度越快

由上述分析可建立微分方程模型：
$$
\begin{cases}
\frac{dn_{1}(t)}{dt}=-s_{2}h_{2}(t)n_{2}(t)-\alpha_{1} n_{1}(t)+r_{1}(t)\\
\frac{dn_{2}(t)}{dt}=-s_{1}h_{1}(t)n_{1}(t)-\alpha_{2} n_{2}(t)+r_{2}(t)\\
\end{cases}
$$
其中
$$
n_{1}(0)=n_{a},n_{2}(0)=n_{b}\\
r_{1}(t)=\gamma_{1} (e^{1-\frac{n_{1}(t)}{n_{a}}}-1),r_{2}(t)=\gamma_{2}(e^{1-\frac{n_{2}(t)}{n_{b}}}-1)
$$

#### 正规战争

假设正规战争下，每个士兵均不隐藏，命中率恒定

即
$$
h_{1}(t)=\beta_{1},h_{2}(t)=\beta_{2}
$$
则有
$$
\begin{cases}
\frac{dn_{1}(t)}{dt}=-s_{2}\beta_{2} n_{2}(t)-\alpha_{1} n_{1}(t)+\gamma_{1}(e^{1-\frac{n_{1}(t)}{n_{a}}}-1)\\
\frac{dn_{2}(t)}{dt}=-s_{1}\beta_{1} n_{1}(t)-\alpha_{2} n_{2}(t)+\gamma_{2}(e^{1-\frac{n_{2}(t)}{n_{b}}}-1)\\
\end{cases}
$$
使用Matlab dsolve函数提示无解析解，因此此处我们求数值解：

 忽略非战争因素对兵力的影响以及增援数，得到方程组：
$$
\begin{cases}
\frac{dn_{1}(t)}{dt}=-s_{2}\beta_{2} n_{2}(t)\\
\frac{dn_{2}(t)}{dt}=-s_{1}\beta_{1} n_{1}(t)\\
n_{1}(0)=n_{a},n_{2}(0)=n_{b}
\end{cases}
$$
进一步得到
$$
\frac{dn_{1}(t)}{dn_{2}(t)}=\frac{s_{2}\beta_{2} n_{2}(t)}{s_{1}\beta_{1} n_{1}(t)}
$$
解上式方程得：
$$
s_{1}\beta_{1}n_{1}^{2}-s_{2}\beta_{2}n_{2}^{2}=C\\
而C=s_{1}\beta_{1}n_{a}^{2}-s_{2}\beta_{2}n_{b}^{2}
$$
由n1,n2的函数可得n1,n2的图像为双曲线，下面我们围绕常数C进行讨论：

当C>0时，双曲线关于n2=0对称，在第一象限中双曲线始终在n1=n2这条线下方，即n1<n2，因此乙军获胜；

当C=0时，甲乙战平；

当C<0时，双曲线关于n1=0对称，在第一象限中双曲线始终在n1=n2这条线上方，即n1>n2，因此甲军获胜；

#### 游击战争

假设游击战争中，所有士兵均会隐藏在地形中，因此命中率与对方人员密度成正比，如果我们假设隐蔽面积是固定的，命中率就仅仅与对方人员数量成正比，由此我们假设：
$$
h_{1}(t)=k_{1}n_{2}(t),h_{2}(t)=k_{2}n_{1}(t)
$$
其中，$k_{1},k_{2}$为常数

则有
$$
\begin{cases}
\frac{dn_{1}(t)}{dt}=-s_{2}k_{2}n_{1}(t) n_{2}(t)-\alpha_{1} n_{1}(t)+\gamma_{1}(e^{1-\frac{n_{1}(t)}{n_{a}}}-1)\\
\frac{dn_{2}(t)}{dt}=-s_{1}k_{1}n_{2}(t) n_{1}(t)-\alpha_{2} n_{2}(t)+\gamma_{2}(e^{1-\frac{n_{2}(t)}{n_{b}}}-1)\\
\end{cases}
$$
使用Matlab dsolve函数提示无解析解，因此此处我们求数值解：

 忽略非战争因素对兵力的影响以及增援数，得到方程组：
$$
\begin{cases}
\frac{dn_{1}(t)}{dt}=-s_{2}k_{2}n_{1}(t) n_{2}(t)\\
\frac{dn_{2}(t)}{dt}=-s_{1}k_{1}n_{2}(t) n_{1}(t)\\
n_{1}(0)=n_{a},n_{2}(0)=n_{b}
\end{cases}
$$
进一步得到
$$
\frac{dn_{1}(t)}{dn_{2}(t)}=\frac{s_{2}k_{2}}{s_{1}k_{1}}
$$
解上述方程得
$$
n_{1}=\frac{s_{2}k_{2}}{s_{1}k_{1}}n_{2}
$$
由上述解析式可得到n1,n2成正比例关系，下面对系数进行讨论：

设$C=\frac{s_{2}k_{2}}{s_{1}k_{1}}>0$

0<C<1时，n1<n2，乙军获胜；

C=1时，n1=n2，甲乙战平；

C>1时，n1>n2，甲军获胜
