# Markov模型

## 题目描述

![image-20220718181838228](E:\MathModel\MathModelWorks\7月11日 马氏链模型\stem.png)

## 解答

### 假设

设状态概率为a(i)，表示第i周周末的状态列向量

售出一辆的净利润为m;

每周净利润由利润期望值表示。

### 建模&分析

X(n)=0或1时，X(n)<=s，n+1周的开始存货为5，X(n+1)可能的取值有2,3,4,5

X(n)=2时，X(n)>s，n+1周的开始存货仍为2，X(n+1)可能的取值有0,1,2

X(n)=3时，X(n)>s，n+1周的开始存货仍为3，X(n+1)可能的取值有0,1,2,3

X(n)=4时，X(n)>s，n+1周的开始存货仍为4，X(n+1)可能的取值有1,2,3,4

X(n=5)时，X(n)>s，n+1周的开始存货仍为5，X(n+1)可能的取值有2,3,4,5
$$
P_{00}=P_{01}=0\\
P_{02}=P(D_{n+1}=3)=0.1\\
P_{03}=P(D_{n+1}=2)=0.2\\
P_{04}=P(D_{n+1}=1)=0.4\\
P_{05}=P(D_{n+1}=0)=0.3\\
\\
P_{10}=P_{11}=0\\
P_{12}=P(D_{n+1}=3)=0.1\\
P_{13}=P(D_{n+1}=2)=0.2\\
P_{14}=P(D_{n+1}=1)=0.4\\
P_{15}=P(D_{n+1}=0)=0.3\\
\\
P_{20}=P(D_{n+1}=2)+P(D_{n+1}=3)=0.3\\
P_{21}=P(D_{n+1}=1)=0.4\\
P_{22}=P(D_{n+1}=0)=0.3\\
P_{23}=P_{24}=P_{25}=0\\
\\
P_{30}=P(D_{n+1}=3)=0.1\\
P_{31}=P(D_{n+1}=2)=0.2\\
P_{32}=P(D_{n+1}=1)=0.4\\
P_{33}=P(D_{n+1}=0)=0.3\\
P_{34}=P_{35}=0\\
\\
P_{40}=0\\
P_{41}=P(D_{n+1}=3)=0.1\\
P_{42}=P(D_{n+1}=2)=0.2\\
P_{43}=P(D_{n+1}=1)=0.4\\
P_{44}=P(D_{n+1}=0)=0.3\\
P_{45}=0\\
\\
P_{50}=P_{51}=0\\
P_{52}=P(D_{n+1}=3)=0.1\\
P_{53}=P(D_{n+1}=2)=0.2\\
P_{54}=P(D_{n+1}=1)=0.4\\
P_{55}=P(D_{n+1}=0)=0.3\\
$$
因此，一步转移概率矩阵为：

```
P = 6×6
         0         0    0.1000    0.2000    0.4000    0.3000
         0         0    0.1000    0.2000    0.4000    0.3000
    0.3000    0.4000    0.3000         0         0         0
    0.1000    0.2000    0.4000    0.3000         0         0
         0    0.1000    0.2000    0.4000    0.3000         0
         0         0    0.1000    0.2000    0.4000    0.3000
```

使用Matlab计算得到，无论a(0)为多少，经过足够多的周后始终稳定为一个确定的向量：
$$
n\to \infty,\ a(n)=\omega=[0.0909,0.1556,0.2310,0.2156,0.2012,0.1057]
$$


每周期望销售数量Sale（单位：辆）和净利润Profit：
$$
\begin{align}
Sale
&=\sum_{i=0}^{1}{[\sum_{j=0}^{5}{(5-j)P_{ij}}]\cdot \omega_{i}}+\sum_{i=2}^{5}{[\sum_{j=0}^{5}{(i-j)P_{ij}}]\cdot \omega_{i}}\\
&=1.07689938398357\\
Profit
&=Sale\times m
\end{align}
$$
